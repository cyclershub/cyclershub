---
import { getCollection } from "astro:content";
import Preview from "../../../components/Gallery/Preview.svelte";
import Layout from "../../../layouts/Layout.astro";
import { ReviewCategories } from "~/lib/ReviewCategories";

let category = Astro.params.category as string;

const reviews = await getCollection("reviews");

if (!ReviewCategories.hasOwnProperty(category)) {
	category = "all";
}

let entries = reviews;

if (category !== "all") {
	entries = reviews.filter((entry) => entry.data.category === category);
}
---

<Layout title="Reviews | The CyclersHub">
	<div class="bg-stone-200 py-16 px-8 lg:px-16 text-center">
		<span class="uppercase text-stone-900 font-bold tracking-wide text-sm">
			{ReviewCategories[category]}
		</span>
		<h1 class="font-bold tracking-wide m-0">Bicycle Touring Gear</h1>
		<h2 class="font-bold text-lg tracking-wider mb-4">Reviews And Roundups</h2>
		<p class="font-semibold text-base max-w-[800px] mx-auto">
			A growing compilation of reviews, from bikepacking bags to bike
			components, apparel and camping gear. Sort through reviews by category, or
			find the latest below.
		</p>
	</div>
	<div class="bg-stone-100 py-16 px-8 lg:px-16 text-center">
		<div class="columns-1 md:columns-2 lg:columns-3 gap-8 [&>*]:mb-8">
			{
				entries.map((entry) => (
					<Preview
						entry={{
							title: entry.data.title,
							author: entry.data.author,
							cover: entry.data.cover,
						}}
						href={`/reviews/${entry.slug}`}
					/>
				))
			}

			{entries.length == 0 ? <h2>There are currently no reviews in this category.</h2> : ""}
		</div>
	</div>
</Layout>
